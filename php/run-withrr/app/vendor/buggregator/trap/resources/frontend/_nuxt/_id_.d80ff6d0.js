import{I as H,h as j,_ as N}from"./layout-sidebar.vue.66485d1b.js";import{d as R,q as L,o as a,a as r,b as t,n as P,f as s,u as e,x as V,F as y,r as T,t as c,h as m,_ as B,c as k,e as v,w as d,g as u,p as x,i as M,j as Y,k as O,l as F}from"./entry.769d5560.js";import{u as U}from"./fetch.ca63033f.js";import{P as q}from"./page-header.68d25fa4.js";import{u as z,R as W}from"./use-events.a9188a22.js";import{u as G}from"./use-smtp.40f741b0.js";import{P as w,W as J}from"./vue3-tabs-component.86d937e7.js";import{a as K,T as b}from"./table-base.7c3f5cae.js";import{C as A}from"./code-snippet.d9f3d8a2.js";import{F as Q}from"./file-attachment.a46b62ae.js";import"./use-formats.c79ce0bd.js";const X={class:"smtp-page-preview"},Z={class:"smtp-page-preview__in"},ee={class:"smtp-page-preview__device-in"},te=R({__name:"smtp-page-preview",props:{device:{default:"desktop"}},setup(o){const p=L(o.device);return(_,i)=>(a(),r("div",X,[t("div",Z,[t("button",{class:P(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="mobile"}]),onClick:i[0]||(i[0]=h=>p.value="mobile")},[s(e(H),{class:"smtp-page-preview__btn-icon",name:"mobile-device"})],2),t("button",{class:P(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="tablet"}]),onClick:i[1]||(i[1]=h=>p.value="tablet")},[s(e(H),{class:"smtp-page-preview__btn-icon",name:"tablet-device"})],2),t("button",{class:P(["smtp-page-preview__btn",{"smtp-page-preview__btn--active":p.value==="desktop"}]),onClick:i[2]||(i[2]=h=>p.value="desktop")},[s(e(H),{class:"smtp-page-preview__btn-icon",name:"desktop-device"})],2)]),t("div",{class:P(["smtp-page-preview__device",{"smtp-page-preview__device--desktop":p.value==="desktop","smtp-page-preview__device--tablet":p.value==="tablet","smtp-page-preview__device--mobile":p.value==="mobile"}])},[t("div",ee,[V(_.$slots,"default")])],2)]))}});const se={class:"smtp-page-addresses"},ae={key:0,class:"smtp-page-addresses__item-name"},ne=R({__name:"smtp-page-addresses",props:{addresses:{}},setup(o){return(n,p)=>(a(),r("div",se,[(a(!0),r(y,null,T(n.addresses,_=>(a(),r("div",{key:_.email,class:"smtp-page-addresses__item"},[_.name?(a(),r("span",ae,c(_.name),1)):m("",!0),t("span",null,c(_.email),1)]))),128))]))}});const I=B(ne,[["__scopeId","data-v-217deb6c"]]),oe=o=>(x("data-v-1fbbb238"),o=o(),M(),o),le={ref:"main",class:"smtp-page"},de={class:"smtp-page__main"},pe={class:"smtp-page__header"},re={class:"smtp-page__header-title"},_e={class:"smtp-page__header-meta"},ie={class:"smtp-page__header-date"},ce={class:"smtp-page__sender"},me={class:"smtp-page__sender-title"},ue={class:"smtp-page__sender-address"},ve={class:"smtp-page__body"},he=["innerHTML"],ge={class:"mb-5"},fe={class:"flex gap-x-3"},be=oe(()=>t("h3",{class:"mb-3 font-bold"},"Email Headers",-1)),ye=R({__name:"smtp-page",props:{event:{},htmlSource:{}},setup(o){const n=o,p=L(n.htmlSource||n.event.payload.html),_=k(()=>[{title:"From",address:n.event.payload.from},{title:"To",address:n.event.payload.to},{title:"CC",address:n.event.payload.cc},{title:"BCC",address:n.event.payload.bcc},{title:"Reply to",address:n.event.payload.reply_to}]),i=k(()=>{var l,$;return((l=n.event.payload)==null?void 0:l.html)!==void 0&&(($=n.event.payload)==null?void 0:$.html)!==""}),h=k(()=>{var l,$;return((l=n.event.payload)==null?void 0:l.text)!==void 0&&(($=n.event.payload)==null?void 0:$.text)!==""}),g=k(()=>n.event.payload),E=k(()=>j(n.event.date).format("DD.MM.YYYY HH:mm:ss")),S=k(()=>Array.isArray(n.event.payload.attachments)?n.event.payload.attachments:Object.values(n.event.payload.attachments||{}));return(l,$)=>(a(),r("div",le,[t("main",de,[t("header",pe,[t("h2",re,c(g.value.subject),1),t("div",_e,[t("span",ie,c(E.value),1)])]),t("section",ce,[(a(!0),r(y,null,T(_.value,f=>(a(),r(y,null,[(a(!0),r(y,null,T(f.address,C=>(a(),r("div",{key:`${f.title}-${C.email}`,class:P(["smtp-page__sender-item",`smtp-page__sender-${f.title.toLowerCase()}`])},[t("div",me,c(f.title),1),t("div",ue,[C.name?(a(),r(y,{key:0},[v(c(C.name)+" ["+c(C.email)+"] ",1)],64)):(a(),r(y,{key:1},[v(c(C.email),1)],64))])],2))),128))],64))),256))]),t("section",ve,[s(e(J),{options:{useUrlFragment:!1}},{default:d(()=>[i.value?(a(),u(e(w),{key:0,id:"html-preview",name:"Preview",suffix:"<span class='smtp-page__body-tab-badge'>HTML</span>"},{default:d(()=>[s(e(te),{device:"tablet"},{default:d(()=>[t("div",{innerHTML:p.value},null,8,he)]),_:1})]),_:1})):m("",!0),i.value?(a(),u(e(w),{key:1,name:"HTML"},{default:d(()=>[s(e(A),{language:"html",class:"max-w-full",code:l.event.payload.html},null,8,["code"])]),_:1})):m("",!0),h.value?(a(),u(e(w),{key:2,name:"Text"},{default:d(()=>[s(e(A),{language:"html",class:"max-w-full",code:l.event.payload.text},null,8,["code"])]),_:1})):m("",!0),S.value.length?(a(),u(e(w),{key:3,name:"Attachments",suffix:`<span class='smtp-page__body-tab-badge'>${S.value.length}</span>`},{default:d(()=>[t("section",ge,[t("div",fe,[(a(!0),r(y,null,T(S.value,f=>(a(),u(e(Q),{key:f.id,"event-id":l.event.id,event:l.event,attachment:f},null,8,["event-id","event","attachment"]))),128))])])]),_:1},8,["suffix"])):m("",!0),s(e(w),{name:"Raw"},{default:d(()=>[s(e(A),{language:"html",code:l.event.payload.raw},null,8,["code"])]),_:1}),s(e(w),{name:"Tech Info"},{default:d(()=>[t("section",null,[be,s(e(K),null,{default:d(()=>[s(e(b),{title:"Id"},{default:d(()=>[v(c(l.event.payload.id),1)]),_:1}),s(e(b),{title:"Subject"},{default:d(()=>[v(c(l.event.payload.subject),1)]),_:1}),s(e(b),{title:"From"},{default:d(()=>[s(e(I),{addresses:l.event.payload.from},null,8,["addresses"])]),_:1}),s(e(b),{title:"To"},{default:d(()=>[s(e(I),{addresses:l.event.payload.to},null,8,["addresses"])]),_:1}),l.event.payload.cc.length?(a(),u(e(b),{key:0,title:"Cc"},{default:d(()=>[s(e(I),{addresses:l.event.payload.cc},null,8,["addresses"])]),_:1})):m("",!0),l.event.payload.bcc.length?(a(),u(e(b),{key:1,title:"Bcc"},{default:d(()=>[s(e(I),{addresses:l.event.payload.bcc},null,8,["addresses"])]),_:1})):m("",!0),l.event.payload.reply_to.length?(a(),u(e(b),{key:2,title:"Reply to"},{default:d(()=>[s(e(I),{addresses:l.event.payload.reply_to},null,8,["addresses"])]),_:1})):m("",!0)]),_:1})])]),_:1})]),_:1})])])],512))}});const $e=B(ye,[["__scopeId","data-v-1fbbb238"]]),{normalizeSmtpEvent:ke}=G(),we=R({components:{SmtpPage:$e,PageHeader:q},async setup(){const o=Y(),n=O(),p=o.params.id,{events:_}=z(),{data:i,pending:h}=await U(_.getUrl(p),{onResponse({response:g}){return g.data},onResponseError(){n.push("/404")},onRequestError(){n.push("/404")}},"$pRkmObBT4O");return{serverEvent:i,pending:h,eventId:p,html:`<iframe src="${W}/api/smtp/${p}/html"/>`,clearEvent:()=>_.removeById(p)}},head(){return{title:`SMTP > ${this.eventId} | Buggregator`}},computed:{event(){return this.serverEvent?ke(this.serverEvent):null}},methods:{onDelete(){this.clearEvent(),this.$router.push("/")}}});const D=o=>(x("data-v-f41ebbc1"),o=o(),M(),o),Se={class:"smtp-event"},Ce={key:0,class:"smtp-event__loading"},Ie=D(()=>t("div",null,null,-1)),Pe=D(()=>t("div",null,null,-1)),Te=D(()=>t("div",null,null,-1)),Re=[Ie,Pe,Te],Ee={class:"smtp-event__body"};function He(o,n,p,_,i,h){const g=N,E=F("PageHeader"),S=F("SmtpPage");return a(),r("main",Se,[s(E,{class:"smtp-event__head","button-title":"Delete event",onDelete:o.onDelete},{default:d(()=>[s(g,{to:"/"},{default:d(()=>[v("Home")]),_:1}),v(" /  "),s(g,{to:"/smtp"},{default:d(()=>[v("Smtp")]),_:1}),v(" /  "),s(g,{disabled:!0},{default:d(()=>[v(c(o.eventId),1)]),_:1})]),_:1},8,["onDelete"]),o.pending&&!o.event?(a(),r("div",Ce,Re)):m("",!0),t("div",Ee,[o.event?(a(),u(S,{key:0,event:o.event,"html-source":o.html},null,8,["event","html-source"])):m("",!0)])])}const Oe=B(we,[["render",He],["__scopeId","data-v-f41ebbc1"]]);export{Oe as default};
